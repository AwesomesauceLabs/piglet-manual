<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Awesomesauce Labs" />
  <title>Manual: Piglet glTF Importer 1.0.4</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
  </style>
  <link rel="stylesheet" href="css/classless.css" type="text/css" />
</head>
<body>
<div id="header">
<h1 class="title">Manual: Piglet glTF Importer 1.0.4</h1>
</div>
<ul>
<li>Online documentation: <a href="https://awesomesaucelabs.github.io/piglet-manual/" class="uri">https://awesomesaucelabs.github.io/piglet-manual/</a></li>
<li>Support e-mail: <a href="mailto:awesomesaucelabs@gmail.com">awesomesaucelabs@gmail.com</a></li>
</ul>
<div class="figure">
<img src="images/piglet-logo.png" width="400" />

</div>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#caveats">Caveats</a></li>
<li><a href="#setup">Setup</a></li>
<li><a href="#editor-imports">Editor Imports</a>
<ul>
<li><a href="#piglet-options-window">Piglet Options Window</a></li>
</ul></li>
<li><a href="#runtime-imports">Runtime Imports</a>
<ul>
<li><a href="#runtime-import-tutorial">Runtime Import Tutorial</a></li>
<li><a href="#runtime-import-api">Runtime Import API</a></li>
</ul></li>
<li><a href="#urp-support">URP Support (Unity 2019.3+)</a></li>
<li><a href="#piglet-viewer">Sample Application: PigletViewer</a></li>
<li><a href="#footnotes">Footnotes</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Piglet is a Unity asset that allows you to import 3D models from glTF files, both in the Editor and at runtime. This provides Unity developers access to a large collection of free textures, materials, and models from sites like <a href="https://sketchfab.com/">Sketchfab</a> and <a href="https://poly.google.com">Google Poly</a><sup><a href="#footnote1">1</a></sup>.</p>
<p>Visit the <a href="https://awesomesaucelabs.github.io/piglet-webgl-demo/">Web Demo</a><sup><a href="#footnote2">2</a></sup> to try Piglet before you buy it.</p>
<h2 id="features">Features</h2>
<ul>
<li>import glTF models in the Editor or at runtime</li>
<li>import glTF models from <code>.gltf</code>, <code>.glb</code>, or <code>.zip</code> files, using file paths or HTTP URLs</li>
<li>extract textures and materials from glTF models, for use with your own 3D models</li>
<li>tested with glTF models from <a href="https://sketchfab.com/">Sketchfab</a>, <a href="https://poly.google.com">Google Poly</a><sup><a href="#footnote1">1</a></sup>, and <a href="https://www.blender.org/">Blender</a></li>
<li>supported platforms: Windows, Android, WebGL (Unity 2018.4 or newer)</li>
<li>full source code provided</li>
</ul>
<h2 id="caveats">Caveats</h2>
<ul>
<li><strong>Piglet does not import animations (yet!)</strong>. However, glTF models containing animation data can still be imported as static models. In addition, any skinning data or blendshape data (a.k.a. &quot;morph targets&quot;) will be correctly imported alongside the model(s).</li>
<li><strong>Runtime imports may stall the main Unity thread</strong>. While I have attempted to minimize interruptions to the main Unity thread during runtime imports, I cannot provide any hard guarantees about this yet. Unity requires certain operations (e.g. mesh creation) to be performed on the main Unity thread, and so it is possible for runtime imports of large/complex models to cause &quot;hiccups&quot; during game execution.</li>
</ul>
<h2 id="setup">Setup</h2>
<p>To set up Piglet in your project, purchase and install Piglet from the Unity Asset Store page. Piglet works with Unity 2018.4 or later, and does not require installation of any third-party dependencies. If you wish to try your own glTF models with Piglet prior to purchasing the asset, please see the <a href="https://awesomesaucelabs.github.io/piglet-webgl-demo/">Piglet WebGL Demo</a>.</p>
<p>Piglet bundles the following libraries:</p>
<table>
<thead>
<tr class="header">
<th align="left">Library</th>
<th align="left">Author</th>
<th align="left">License</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://www.newtonsoft.com/json">Json.NET</a></td>
<td align="left"><a href="https://www.newtonsoft.com">Newtonsoft</a></td>
<td align="left">MIT License</td>
<td align="left"><code>Assets/Piglet/Dependencies/Json.NET</code></td>
</tr>
<tr class="even">
<td align="left"><a href="https://github.com/icsharpcode/SharpZipLib">SharpZipLib</a></td>
<td align="left"><a href="https://github.com/icsharpcode">icsharpcode@github</a></td>
<td align="left">MIT License</td>
<td align="left"><code>Assets/Piglet/Dependencies/SharpZipLib</code></td>
</tr>
<tr class="odd">
<td align="left"><a href="https://github.com/sketchfab/UnityGLTF">UnityGLTF</a></td>
<td align="left"><a href="https://www.khronos.org/">Khronos</a>/<a href="https://sketchfab.com">Sketchfab</a></td>
<td align="left">MIT License</td>
<td align="left"><code>Assets/Piglet/Dependencies/UnityGLTF</code></td>
</tr>
</tbody>
</table>
<p><em>Note</em>: If your Unity project already includes one of these libraries (e.g. Json.NET), you may get errors in the Unity Console due to duplicate function/class definitions. In most cases, removing Piglet's copy of the library under <code>Assets/Piglet/Dependencies</code> should solve the issue.</p>
<h2 id="editor-imports">Editor Imports</h2>
<p><em>Note</em>: For a video demonstration of Piglet Editor imports, see <a href="https://youtu.be/wf26w0gcVcA" class="uri">https://youtu.be/wf26w0gcVcA</a>.</p>
<p>Once you have installed Piglet from the Unity Asset Store, you can import glTF models into your Unity project by dragging-and-dropping <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> files from a file browser window (e.g. Windows File Explorer) to a folder inside the Unity Project Browser (Figure 1). Any folder under <code>Assets</code> can be used as the drop target, including the <code>Assets</code> directory itself.</p>
<p>Importing a glTF file in the Editor produces a Unity prefab for the model, which can then be dragged into your Unity scenes as desired. Piglet places the generated prefab and any dependent asset files (e.g. textures, materials, meshes) under a newly-created subfolder named after the input <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> file.</p>
<div class="figure">
<img src="images/editor-import-figure.png" id="editor-import-figure" width="1024" />

</div>
<p>Figure 1: Importing a glTF model in the Editor. (A) The user drags-and-drops a .gltf/.glb/.zip file from Windows File Explorer to the Unity Project Browser window. (B) Piglet creates a Unity prefab for the model and opens it in the Prefab View.</p>
<p>There may be circumstances where you want copy a <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> file into your project without automatically converting it to a Unity prefab. You can bypass/disable Piglet's default drag-and-drop behaviour by any of the following methods:</p>
<ul>
<li>Hold down the <code>Control</code> or <code>Command</code> key while dragging-and-dropping the <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> into the Unity Project Browser.</li>
<li>Uncheck <code>Enable drag-and-drop glTF import</code> in the Piglet Options window, located under <code>Window =&gt; Piglet Options</code> in the Unity menu.</li>
<li>Copy the <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> file into the Unity project directory from a file browser window or on the command line. (In other words, copy the file &quot;behind Unity's back&quot;.)</li>
</ul>
<p>Piglet Options Window</p>
<p>A number of options relating Editor imports can be set in the Piglet Options window, located under <code>Window =&gt; Piglet Options</code> in the Unity menu.</p>
<div class="figure">
<img src="images/piglet-options-window.png" />

</div>
<table>
<thead>
<tr class="header">
<th align="left">Option</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>Enable drag-and-drop glTF import</code></td>
<td align="left">Enable/disable automatic glTF imports when dragging .gltf/.glb/.zip files onto the Project Browser window</td>
</tr>
<tr class="even">
<td align="left"><code>Prompt before overwriting files</code></td>
<td align="left">Show confirmation prompt if glTF import directory already exists</td>
</tr>
<tr class="odd">
<td align="left"><code>Print progress messages in Console</code></td>
<td align="left">Log progress messages to Unity Console window during glTF imports (useful for debugging)</td>
</tr>
<tr class="even">
<td align="left"><code>Select prefab in Project Browser</code></td>
<td align="left">After a glTF import has completed, select/highlight the generated prefab in the Project Browser window</td>
</tr>
<tr class="odd">
<td align="left"><code>Add prefab instance to scene</code></td>
<td align="left">After a glTF import has completed, add the generated prefab to the current Unity scene, as a child of the currently selected game object. If no game object is selected in the scene, add the prefab at the root of the scene instead.</td>
</tr>
<tr class="even">
<td align="left"><code>Select prefab instance in scene</code></td>
<td align="left">Select/highlight the prefab in the scene hierarchy after adding it to the scene</td>
</tr>
<tr class="odd">
<td align="left"><code>Open prefab in Prefab View</code></td>
<td align="left">After a glTF import has completed, open the generated prefab in the Prefab View. (This is equivalent to double-clicking the prefab in the Project Browser.)</td>
</tr>
</tbody>
</table>
<h2 id="runtime-imports">Runtime Imports</h2>
<p>Piglet can import a glTF model at runtime from a file path, an HTTP URL, or a <code>byte[]</code> array containing the raw byte content of a .gltf/.glb/.zip file. Runtime imports are performed incrementally, with minimum possible interruption to the main Unity thread.</p>
<h3 id="runtime-import-tutorial">Runtime Import Tutorial</h3>
<p>This section walks through example code for importing a glTF model at runtime. The example code in this section is included with Piglet under <code>Assets/Piglet/Examples/RuntimeImport</code>, and a video version of this tutorial is available online at <a href="https://youtu.be/f66wmgSTPI0" class="uri">https://youtu.be/f66wmgSTPI0</a>.</p>
<p>As our example glTF model, we will use the <code>.glb</code> file for Sir Piggleston (the Piglet mascot), which may be downloaded from <a href="https://awesomesaucelabs.github.io/piglet-webgl-demo/StreamingAssets/piggleston.glb" class="uri">https://awesomesaucelabs.github.io/piglet-webgl-demo/StreamingAssets/piggleston.glb</a>. The minimal code to import the model at runtime is as follows:</p>
<div class="sourceCode"><pre class="sourceCode cs"><code class="sourceCode cs"><span class="kw">using</span> Piglet;
<span class="kw">using</span> UnityEngine;

<span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
<span class="co">/// This MonoBehaviour provides a minimal example for using</span>
<span class="co">/// Piglet to import glTF models at runtime.</span>
<span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
<span class="kw">public</span> <span class="kw">class</span> RuntimeImportBehaviour : MonoBehaviour
{
    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// The currently running glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="kw">private</span> GltfImportTask _task;

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Unity callback that is invoked before the first frame.</span>
    <span class="co">/// Create the glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="dt">void</span> <span class="fu">Start</span>()
    {
        <span class="co">// Note: To import a local .gltf/.glb/.zip file, you may</span>
        <span class="co">// instead pass an absolute file path to GetImportTask</span>
        <span class="co">// (e.g. &quot;C:/Users/Joe/Desktop/piggleston.glb&quot;), or a byte[]</span>
        <span class="co">// array containing the raw byte content of the file.</span>

        _task = RuntimeGltfImporter.<span class="fu">GetImportTask</span>(
                <span class="st">&quot;https://awesomesaucelabs.github.io/piglet-webgl-demo/StreamingAssets/piggleston.glb&quot;</span>);
    }

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Unity callback that is invoked after every frame.</span>
    <span class="co">/// Here we call MoveNext() to advance execution</span>
    <span class="co">/// of the glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="dt">void</span> <span class="fu">Update</span>()
    {
        <span class="co">// advance execution of glTF import task</span>
        _task.<span class="fu">MoveNext</span>();
    }
}</code></pre></div>
<p>Figure 2: Minimal code to import a glTF file at runtime.</p>
<p>As shown in Figure 2, a runtime glTF import happens in two parts. First, we create an import task by calling <code>RuntimeGltfImporter.GetImportTask</code>, passing in the URL of the glTF model as a parameter. To load a local .gltf/.glb/.zip file, we may instead pass <code>GetImportTask</code> an absolute file path (e.g. &quot;C:/Users/Joe/Desktop/piggleston.glb&quot;) or a <code>byte[]</code> array containing the raw byte content of the file. Second, we advance the execution of the import task by repeatedly calling <code>MoveNext()</code> on the task. A convenient place to call <code>MoveNext()</code> is in the <code>Update()</code> method, which is called by Unity once per frame. Continuing to call <code>MoveNext()</code> after the import has completed does no harm.</p>
<p>Attaching the script from Figure 2 to any game object in your Unity scene is sufficient to import a glTF model at runtime. However, in a real game/application, you will probably want tighter integration between your own code and the importer. For example, you may want to show progress messages while the model is loading, or to attach custom MonoBehaviours to the model once it has loaded. To achieve these types of behaviours, <code>GltfImportTask</code> provides callback hooks for: progress messages (<code>OnProgress</code>), user cancelation (<code>OnAborted</code>), import errors (<code>OnException</code>), and successful completion (<code>OnCompleted</code>).</p>
<p>As a first example of callback usage, we'll extend the example script from Figure 2 to print progress messages during the glTF import. We can achieve this by assigning a custom method to the <code>OnProgress</code> callback for the import task, as shown in Figure 3.</p>
<div class="sourceCode"><pre class="sourceCode cs"><code class="sourceCode cs"><span class="kw">using</span> Piglet;
<span class="kw">using</span> UnityEngine;

<span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
<span class="co">/// This MonoBehaviour provides a minimal example for using</span>
<span class="co">/// Piglet to import glTF models at runtime.</span>
<span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
<span class="kw">public</span> <span class="kw">class</span> RuntimeImportBehaviour : MonoBehaviour
{
    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// The currently running glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="kw">private</span> GltfImportTask _task;

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Unity callback that is invoked before the first frame.</span>
    <span class="co">/// Create the glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="dt">void</span> <span class="fu">Start</span>()
    {
        <span class="co">// Note: To import a local .gltf/.glb/.zip file, you may</span>
        <span class="co">// instead pass an absolute file path to GetImportTask</span>
        <span class="co">// (e.g. &quot;C:/Users/Joe/Desktop/piggleston.glb&quot;), or a byte[]</span>
        <span class="co">// array containing the raw byte content of the file.</span>

        _task = RuntimeGltfImporter.<span class="fu">GetImportTask</span>(
                <span class="st">&quot;https://awesomesaucelabs.github.io/piglet-webgl-demo/StreamingAssets/piggleston.glb&quot;</span>);
        _task.<span class="fu">OnProgress</span> = OnProgress;
    }

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Callback that is invoked by the glTF import task</span>
    <span class="co">/// to report intermediate progress.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="co">/// </span><span class="kw">&lt;param</span><span class="ot"> name=</span><span class="dt">&quot;step&quot;</span><span class="kw">&gt;</span>
    <span class="co">/// The current step of the glTF import process.  Each step imports</span>
    <span class="co">/// a different type of glTF entity (e.g. textures, materials).</span>
    <span class="co">/// </span><span class="kw">&lt;/param&gt;</span>
    <span class="co">/// </span><span class="kw">&lt;param</span><span class="ot"> name=</span><span class="dt">&quot;completed&quot;</span><span class="kw">&gt;</span>
    <span class="co">/// The number of glTF entities (e.g. textures, materials) that have been</span>
    <span class="co">/// successfully imported for the current import step.</span>
    <span class="co">/// </span><span class="kw">&lt;/param&gt;</span>
    <span class="co">/// </span><span class="kw">&lt;param</span><span class="ot"> name=</span><span class="dt">&quot;total&quot;</span><span class="kw">&gt;</span>
    <span class="co">/// The total number of glTF entities (e.g. textures, materials) that will</span>
    <span class="co">/// be imported for the current import step.</span>
    <span class="co">/// </span><span class="kw">&lt;/param&gt;</span>
    <span class="kw">private</span> <span class="dt">void</span> <span class="fu">OnProgress</span>(ImportStep step, <span class="dt">int</span> completed, <span class="dt">int</span> total)
    {
        Debug.<span class="fu">LogFormat</span>(<span class="st">&quot;{0}: {1}/{2}&quot;</span>, step, completed, total);
    }

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Unity callback that is invoked after every frame.</span>
    <span class="co">/// Here we call MoveNext() to advance execution</span>
    <span class="co">/// of the glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="dt">void</span> <span class="fu">Update</span>()
    {
        <span class="co">// advance execution of glTF import task</span>
        _task.<span class="fu">MoveNext</span>();
    }
}</code></pre></div>
<p>Figure 3: An extension of the runtime import script from Figure 2 that prints progress messages to the Unity console. In comparison to Figure 2, the new parts of the code are the <code>OnProgress</code> method and the assignment of <code>OnProgress</code> to <code>_task.OnProgress</code> in <code>Start</code>.</p>
<p>Another important use of callbacks is to run custom code after a glTF import has successfully completed. For example, you might want to automatically resize the model, parent the model to another game object, or attach a custom <code>MonoBehaviour</code> to the model. These types of tasks can be accomplished using the <code>OnCompleted</code> callback. To demonstrate, the example script in Figure 4 uses the <code>OnCompleted</code> callback to obtain a reference to the imported model, then uses that reference to continually spin the model about the y-axis as if it were on a record turntable.</p>
<p>The example in Figure 4 marks the end of this tutorial. Good luck and happy coding!</p>
<div class="sourceCode"><pre class="sourceCode cs"><code class="sourceCode cs"><span class="kw">using</span> Piglet;
<span class="kw">using</span> UnityEngine;

<span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
<span class="co">/// This MonoBehaviour provides a minimal example for using</span>
<span class="co">/// Piglet to import glTF models at runtime.</span>
<span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
<span class="kw">public</span> <span class="kw">class</span> RuntimeImportBehaviour : MonoBehaviour
{
    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// The currently running glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="kw">private</span> GltfImportTask _task;

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Root GameObject of the imported glTF model.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="kw">private</span> GameObject _model;

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Unity callback that is invoked before the first frame.</span>
    <span class="co">/// Create the glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="dt">void</span> <span class="fu">Start</span>()
    {
        <span class="co">// Note: To import a local .gltf/.glb/.zip file, you may</span>
        <span class="co">// instead pass an absolute file path to GetImportTask</span>
        <span class="co">// (e.g. &quot;C:/Users/Joe/Desktop/piggleston.glb&quot;), or a byte[]</span>
        <span class="co">// array containing the raw byte content of the file.</span>

        _task = RuntimeGltfImporter.<span class="fu">GetImportTask</span>(
            <span class="st">&quot;https://awesomesaucelabs.github.io/piglet-webgl-demo/StreamingAssets/piggleston.glb&quot;</span>);
        _task.<span class="fu">OnCompleted</span> = OnComplete;
    }

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Callback that is invoked by the glTF import task</span>
    <span class="co">/// after it has successfully completed.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="co">/// </span><span class="kw">&lt;param</span><span class="ot"> name=</span><span class="dt">&quot;importedModel&quot;</span><span class="kw">&gt;</span>
    <span class="co">/// the root GameObject of the imported glTF model</span>
    <span class="co">/// </span><span class="kw">&lt;/param&gt;</span>
    <span class="kw">private</span> <span class="dt">void</span> <span class="fu">OnComplete</span>(GameObject importedModel)
    {
        _model = importedModel;
        Debug.<span class="fu">Log</span>(<span class="st">&quot;Success!&quot;</span>);
    }

    <span class="co">/// </span><span class="kw">&lt;summary&gt;</span>
    <span class="co">/// Unity callback that is invoked after every frame.</span>
    <span class="co">/// Here we call MoveNext() to advance execution</span>
    <span class="co">/// of the glTF import task.</span>
    <span class="co">/// </span><span class="kw">&lt;/summary&gt;</span>
    <span class="dt">void</span> <span class="fu">Update</span>()
    {
        <span class="co">// advance execution of glTF import task</span>
        _task.<span class="fu">MoveNext</span>();

        <span class="co">// spin model about y-axis</span>
        <span class="kw">if</span> (_model != <span class="kw">null</span>)
            _model.<span class="fu">transform</span>.<span class="fu">Rotate</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>);
    }
}</code></pre></div>
<p>Figure 4: An extension of the runtime import script from Figure 2 that spins the imported model about the y-axis. In comparison to Figure 2, the new parts of the code are the <code>OnComplete</code> method, the assignment of <code>OnComplete</code> to <code>_task.OnCompleted</code> in <code>Start</code>, and the call to <code>_model.transform.Rotate</code> in <code>Update</code>.</p>
<h3 id="runtime-import-api">Runtime Import API</h3>
<p>In Piglet, a runtime glTF import is accomplished by the following steps:</p>
<ol style="list-style-type: decimal">
<li>Create a <code>GltfImportTask</code> by calling <code>RuntimeGltfImporter.GetImportTask</code>, passing in the file path or URL of the input <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> as a parameter.</li>
<li>Configure callbacks on the <code>GltfImportTask</code> (optional).</li>
<li>Call <code>MoveNext()</code> on the <code>GltfImportTask</code> until the glTF import has completed.</li>
</ol>
<p>For concrete code examples demonstrating the above steps, see the <a href="#runtime-import-tutorial">Runtime Import Tutorial</a>.</p>
<p><code>RuntimeGltfImporter</code> provides the following methods for creating a <code>GltfImportTask</code>:</p>
<table>
<caption>RuntimeGltfImporter Methods</caption>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="left">Return Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>GetImportTask(string uri)</code></td>
<td align="left"><code>GltfImportTask</code></td>
<td align="left">Create an import task that imports the glTF model from <code>uri</code>, where <code>uri</code> is an absolute file path, HTTP(S) URL, or Android content URI that points to a <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> file.</td>
</tr>
<tr class="even">
<td align="left"><code>GetImportTask(Uri uri)</code></td>
<td align="left"><code>GltfImportTask</code></td>
<td align="left">Create an import task that imports the glTF model from <code>uri</code>, where <code>uri</code> is an absolute file path, HTTP(S) URL, or Android content URI that points to a <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> file.</td>
</tr>
<tr class="odd">
<td align="left"><code>GetImportTask(byte[] data)</code></td>
<td align="left"><code>GltfImportTask</code></td>
<td align="left">Create an import task that imports from the raw byte content of a <code>.gltf</code>/<code>.glb</code>/<code>.zip</code> file (<code>data</code>).</td>
</tr>
</tbody>
</table>
<p><code>GltfImportTask</code> provides the following methods for controlling its own execution:</p>
<table>
<caption>GltfImportTask Methods</caption>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>MoveNext()</code></td>
<td align="left">Advance execution of the import task by a small increment. This method should be called repeatedly until the import task has completed.</td>
</tr>
<tr class="even">
<td align="left"><code>Abort()</code></td>
<td align="left">Abort the import task. This method should typically be called in response to a user action, such as pressing a &quot;Cancel&quot; button.</td>
</tr>
</tbody>
</table>
<p>In addition, <code>GltfImportTask</code> provides the following callbacks for integrating custom code with the importer:</p>
<table>
<caption>GltfImportTask Callbacks</caption>
<thead>
<tr class="header">
<th align="left">Callback</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>OnProgress</code></td>
<td align="left">Invoked at regular intervals to report progress of <code>GltfImportTask</code></td>
</tr>
<tr class="even">
<td align="left"><code>OnAborted</code></td>
<td align="left">Invoked when <code>Abort()</code> is called on <code>GltfImportTask</code></td>
</tr>
<tr class="odd">
<td align="left"><code>OnException</code></td>
<td align="left">Invoked when <code>GltfImportTask</code> throws an exception (e.g. file not found)</td>
</tr>
<tr class="even">
<td align="left"><code>OnCompleted</code></td>
<td align="left">Invoked when <code>GltfImportTask</code> completes successfully</td>
</tr>
</tbody>
</table>
<h2 id="urp-support">URP Support (Unity 2019.3+)</h2>
<p>Piglet supports the Universal Render Pipeline (URP) in Unity 2019.3 or newer. To use Piglet in a URP-based project, simply unpack the URP shader files in <code>Assets/Piglet/Extras/URPShaders.unitypackage</code>. (If you to forget unpack <code>URPShaders.unitypackage</code>, glTF imports will fail with an error message reminding you to install the shaders.)</p>
<h2 id="piglet-viewer">Sample Application: PigletViewer</h2>
<div class="figure">
<img src="images/piglet-webgl-demo.png" id="webgl-demo-figure" width="800" />

</div>
<p>Figure 5: A screenshot of PigletViewer, a sample application which uses Piglet to view 3D models from glTF files.</p>
<p>PigletViewer is sample application which uses Piglet to view 3D models from glTF files (`.gltf`, `.glb`, or `.zip`), and which is used for the <a href="https://awesomesaucelabs.github.io/piglet-webgl-demo/">Piglet Web Demo</a>. For the benefit of Piglet customers, I have published the source code and documentation for PigletViewer online at <a href="https://github.com/AwesomesauceLabs/piglet-viewer" class="uri">https://github.com/AwesomesauceLabs/piglet-viewer</a>, under an MIT license. PigletViewer currently supports builds for Android, WebGL, and Windows, and thus it may be a useful reference for Piglet users developing for those platforms. In general, I recommend looking at the <a href="#runtime-import-tutorial">Runtime Import Tutorial</a> before exploring the PigletViewer code, as the tutorial provides a much more succinct introduction to the Piglet API.</p>
<h2 id="footnotes">Footnotes</h2>
<p>1. As of June 2020, Google Poly only provides glTF download links for models made with <a href="https://arvr.google.com/blocks/">Google Blocks</a> (as opposed to <a href="https://www.tiltbrush.com/">Tilt Brush</a>). To see only Blocks-generated models on Google Poly, visit <a href="https://poly.google.com/blocks" class="uri">https://poly.google.com/blocks</a>.</p>
<p>2. I have tested the <a href="https://awesomesaucelabs.github.io/piglet-webgl-demo/">Piglet Web Demo</a> with Firefox and Google Chrome on Windows 10 64-bit. If you are using Google Chrome, you can improve performance of the demo by <a href="https://www.lifewire.com/hardware-acceleration-in-chrome-4125122">turning on hardware acceleration</a> (i.e. GPU acceleration) in the browser settings. Currently this option is disabled in Chrome by default.</p>
</body>
</html>
